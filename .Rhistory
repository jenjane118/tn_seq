mutations <- list()
mut_list <- NULL
for (i in 1:length(tissues)){
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
#print(mut_list)
mutations[i] <- mut_list
}
mut_list
mutations
mutations <- list()
mut_list <- NULL
for (i in 1:length(tissues)){
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
#print(mut_list)
mutations[[i]] <- mut_list
}
mut_list
mutations
tissues <- list(unique(spag_df$tissue))
tissues[1]
tissues[[1]]
tissues[[1][1]]
tissues[[1,]]
tissue_df <- rbind.data.frame(tissues, mutations)
length(mutations)
length(tissues)
tissues <- unique(spag_df$tissue)
tissues[1]
length(mutations)
length(tissues)
tissue_df <- rbind.data.frame(tissues, mutations)
tissue_df <- rbind(tissues, mutations)
tissue_df
mutations
mutations[1]
tissue_df <- rbind(tissues, mutations[1])
tissue_df
tissue_df <- rbind.data.frame(tissues, mutations[1])
tissue_df <- rbind.data.frame(tissues[1], mutations[1])
tissue_df
tissue_df <- colbind.data.frame(tissues[1], mutations[1])
tissue_df <- cbind.data.frame(tissues[1], mutations[1])
tissue_df
tissues[1]
tissue_df <- cbind.data.frame(tissues, mutations[1])
list_mutations <- list()
mutations <- NULL
for (i in 1:length(tissues)){
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
#print(mut_list)
mutations[[i]] <- mut_list
}
mutations[1]
mutations
length(mutations)
length(tissues)
tissue_df <- cbind.data.frame(tissues, mutations)
tissue_df <- cbind(tissues, mutations)
tissue_df
tissues
typeof(tissues)
typeof(mutations)
tissues <- list(unique(spag_df$tissue))
tissues[1]
typeof(tissues)
typeof(mutations)
length(mutations)
length(tissues)
length(tissues[1])
tissues <- list([unique(spag_df$tissue)])
tissues[1]
length(tissues[[1]])
tissues<- tissues[[1]]
tissues
length(mutations)
length(tissues)
typeof(tissues)
tissues<- list(tissues[[1]])
length(tissues)
tissues <- list(unique(spag_df$tissue))
tissues[1]
tissues <- list(unique(spag_df$tissue))
tissues[1]
tissues[[1]]
tissues[[[1]]]
tissues[1]
tissues[[1]]
tissues <- unique(spag_df$tissue)
tissues[[1]]
tissues[1]
typeof(tissues)
typeof(tissues)
length(tissues)
tissues <- character()
tissues <- unique(spag_df$tissue)
tissues[1]
typeof(tissues)
tissues <- unique(spag_df$tissue)
tissues[1]
tissue_matrix <- matrix(nrow=length(tissues), ncol=2)
tissue_matrix
tissue_matrix <- matrix(nrow=length(tissues))
tissue_matrix
tissue_matrix <- matrix(tissues, nrow=length(tissues))
tissue_matrix
tissue_matrix[1]
mutations <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[[i]]]
print(mut_list)
#mutations[[i]] <- mut_list
}
mut_matrix <- matrix(nrow=length(tissues))
mut_matrix[1]
mutations <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[[i]]]
print(mut_list)
mut_matrix[i] <- mut_list
}
mut_matrix
mut_list <- NULL
mut_matrix <- matrix(nrow=length(tissues))
mut_matrix[1]
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[[i]]]
print(mut_list)
#mut_matrix[i] <- mut_list
}
mydata <- read.csv("/Users/jenstiens/git/kinesin_db/SPAG5_tissue.csv", header = (TRUE), stringAsFactors = FALSE)
mydata
spag_df <- data.frame(mydata)
print (spag_df)
cns <- NULL
cns <- spag_df$mutation[spag_df$tissue=='central_nervous_system']
cns
summary(spag_df)
table(spag_df$tissue)
barplot(table(spag_df$tissue))
par()
barplot(table(spag_df$tissue), cex.names=1)
barplot(table(spag_df$tissue), cex.names=0.5)
barplot(table(spag_df$tissue), cex.names=0.25)
barplot(table(spag_df$tissue), cex.names=1.0)
barplot(table(spag_df$tissue), cex.names=0.5)
barplot(table(spag_df$tissue), cex.names=0.5)
table(spag_df$tissue)
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[[i]]]
print(mut_list)
mut_matrix[i] <- mut_list
}
mut_matrix
mydata <- read.csv("/Users/jenstiens/git/kinesin_db/SPAG5_tissue.csv", header = (TRUE), stringAsFactors = FALSE, colClasses='character')
mydata
spag_df <- data.frame(mydata)
summary(spag_df)
table(spag_df$tissue)
barplot(table(spag_df$tissue), cex.names=0.5)
tissue_matrix <- matrix(tissues, nrow=length(tissues))
tissue_matrix[1]
mut_matrix <- matrix(nrow=length(tissues))
mut_matrix[1]
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[[i]]]
print(mut_list)
mut_matrix[i] <- mut_list
}
mut_matrix
warnings()
mut_matrix <- NULL
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[[i]]]
print(mut_list)
mut_matrix[i] <- mut_list
}
mut_matrix
mut_matrix <- list()
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[[i]]]
print(mut_list)
mut_matrix[i] <- mut_list
}
mut_matrix
mut_matrix <- list()
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[[i]]]
print(mut_list)
mut_matrix[[i]] <- mut_list
}
mut_matrix
mydata <- read.csv("/Users/jenstiens/git/kinesin_db/SPAG5_tissue.csv", header = (TRUE), stringAsFactors = FALSE, colClasses='character')
mydata
spag_df <- data.frame(mydata)
tissues <- unique(spag_df$tissue)
tissues[1]
tissue_matrix <- matrix(tissues, nrow=length(tissues))
tissue_matrix[1]
mut_matrix <- list()
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[i]]
print(mut_list)
mut_matrix[[i]] <- mut_list
}
mut_matrix
mut_matrix
combo <- colbind(tissue_matrix, mut_matrix)
combo <- cbind(tissue_matrix, mut_matrix)
combo
mut_matrix <- list()
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[i]]
print(mut_list)
mut_matrix[[i]] <- mut_list[1]
}
mut_matrix
combo <- cbind(tissue_matrix, mut_matrix)
combo
mut_matrix <- list()
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[i]]
print(mut_list)
mut_matrix[[i]] <- mut_list[[1]]
}
mut_matrix
combo <- cbind(tissue_matrix, mut_matrix)
combo
mut_matrix
combo <- cbindlist(tissue_matrix, mut_matrix)
mut_matrix <- matrix(nrow=length(tissue_matrix)
mut_matrix <- matrix(nrow=length(tissue_matrix))
mut_matrix <- matrix(nrow=length(tissue_matrix))
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[i]]
print(mut_list)
mut_matrix[[i]] <- mut_list[[1]]
}
mut_matrix
mut_matrix[1]
mut_matrix <- matrix(nrow=length(tissue_matrix))
mut_matrix[1]
mut_matrix[[1]]
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[i]]
print(mut_list)
mut_matrix[i] <- mut_list[[1]]
}
mut_matrix
mut_list <- NULL
for (i in 1:length(tissue_matrix)){
mut_list <- spag_df$mutation[spag_df$tissue==tissue_matrix[i]]
print(mut_list)
mut_matrix[i] <- mut_list[1]
}
mut_matrix
print (spag_df)
View(spag_df)
summary(spag_df)
table(spag_df$tissue)
uterus <- NULL
uterus<- spag_df$mutation[spag_df$tissue %in% c('endometrium', 'cervix', 'ovary')]
uterus
tissues <- unique(spag_df$tissue)
tissues[1]
tissues
str(spag_df)
mydata <- read.csv("/Users/jenstiens/git/kinesin_db/SPAG5_tissue.csv", header = (TRUE), stringAsFactors = FALSE, colClasses='character')
mydata
spag_df <- data.frame(mydata)
summary(spag_df)
table(spag_df$tissue)
str(spag_df)
mydata <- read.csv("/Users/jenstiens/git/kinesin_db/SPAG5_tissue.csv", header = (TRUE), stringAsFactors = FALSE, colClasses='character')
mydata
str(mydata)
mydata <- read.csv("/Users/jenstiens/git/kinesin_db/SPAG5_tissue.csv", header = TRUE, colClasses='character')
mydata
str(mydata)
spag_df <- data.frame(mydata)
summary(spag_df)
table(spag_df$tissue)
str(spag_df)
barplot(table(spag_df$tissue), cex.names=0.5)
uterus <- NULL
uterus<- spag_df$mutation[spag_df$tissue %in% c('endometrium', 'cervix', 'ovary')]
uterus
tissues <- unique(spag_df$tissue)
tissues
table(spag_df$tissue)
mut_list <- NULL
for (i in 1:length(tissues)){
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
mutations <- c(mutations, mut_list)
}
mutations
mut_matrix <- NULL
tissues <- unique(spag_df$tissue)
tissues
mut_matrix <- NULL
mut_list <- NULL
for (i in 1:length(tissues)){
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
mut_matrix[tissues[i],] <- mut_list
}
mutations
print(mut_list)
mut_list <- NULL
mut_matrix <- NULL
mut_list <- NULL
for (i in 1:length(tissues)){
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
print(mut_list)
mut_matrix[tissues[i],] <- mut_list
}
for (i in 1:length(tissues)){
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
print(mut_list)
print(tissue[i])
mut_matrix[tissues[i],] <- mut_list
}
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
print(mut_list)
print(tissue[i])
#mut_matrix[tissues[i],] <- mut_list
}
tissues <- ch()
tissues <- c()
tissues <- unique(spag_df$tissue)
tissues
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
print(mut_list)
print(tissue[i])
#mut_matrix[tissues[i],] <- mut_list
}
str(spag_df)
tissues <- chr()
typeof(tissues)
tissues <- c()
tissues <- unique(spag_df$tissue)
tissues
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
print(mut_list)
print(tissues[i])
#mut_matrix[tissues[i],] <- mut_list
}
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
#print(mut_list)
#print(tissues[i])
mut_matrix[tissues[i],] <- mut_list
}
mutations
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
#print(mut_list)
#print(tissues[i])
mut_matrix[tissues[i],] <- mut_list
}
mut_matrix
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
#print(mut_list)
#print(tissues[i])
combo_list <- c(combo_list, tissues[i] = mut_list)
}
combo_list
combo_list <- list()
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
#print(mut_list)
#print(tissues[i])
combo_list <- c(combo_list, tissues[i] = mut_list)
}
combo_list
combo_list <- tissues[1] = mut_list
combo_list <- list()
combo_list <- list(tissues[1] = mut_list)
combo_list <- c(tissues[1] = mut_list)
combo_list<-NULL
combo_list <- c(tissues[1] = mut_list)
combo_list <- NULL
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
combo_list <- c(combo_list, mut_list)
}
combo_list
combo_list <- list()
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
combo_list <- mut_list
}
combo_list
combo_list <- list()
for (i in 1:length(tissues)){
mut_list <- NULL
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
combo_list <- c(combo_list, mut_list)
}
combo_list
combo_list <- list()
for (i in 1:length(tissues)){
mut_list <- list()
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
combo_list <- c(combo_list, mut_list)
}
combo_list
mut_list
uterus <- NULL
uterus<- spag_df$mutation[spag_df$tissue %in% c('endometrium', 'cervix', 'ovary')]
uterus
cns <- NULL
cns <- spag_df$mutation[spag_df$tissue=='central_nervous_system']
cns
urinary <- NULL
urinary <- spag_df$mutation[spag_df$tissue %in% c('urinary_tract', 'kidney')]
urinary
tissues <- c()
tissues <- unique(spag_df$tissue)
tissues
combo_list <- list()
for (i in 1:length(tissues)){
mut_list <- list()
mut_list <- spag_df$mutation[spag_df$tissue==tissues[i]]
combo_list <- c(combo_list, tissues[i]=mut_list)  # this is not giving list of lists but just concatenating all
}
mut_list
combo_list
mydata <- read.csv("/Users/jenstiens/git/kinesin_db/SPAG5_tissue.csv", header = TRUE, colClasses='character')
mydata
str(mydata)
spag_df <- data.frame(mydata)
print (spag_df)
View(spag_df)
summary(spag_df)
table(spag_df$tissue)
str(spag_df)
## to regroup or analyse specific tissues, can do something like this:
uterus <- NULL
uterus<- spag_df$mutation[spag_df$tissue %in% c('endometrium', 'cervix', 'ovary')]
uterus
cns <- NULL
cns <- spag_df$mutation[spag_df$tissue=='central_nervous_system']
cns
urinary <- NULL
urinary <- spag_df$mutation[spag_df$tissue %in% c('urinary_tract', 'kidney')]
urinary
## list of unique tissue types
tissues <- c()
tissues <- unique(spag_df$tissue)
tissues
#GFF<-read.table("Genbank-Mbovis-sequence.gff3",header = F,skip = 2,sep = "\t",stringsAsFactors = F,quote = "",fill = T,comment.char = "")
GFF<-read.table("LT708304_updated_aug19.gff",header = F,skip = 2,sep = "\t",stringsAsFactors = F,quote = "",fill = T,comment.char = "")
GFF<-GFF[1:(grep("##FASTA",GFF[,1])-1),]
#GFF<-read.table("Genbank-Mbovis-sequence.gff3",header = F,skip = 2,sep = "\t",stringsAsFactors = F,quote = "",fill = T,comment.char = "")
GFF<-read.table("~/Tn_seq_project/Dong_scripts/LT708304_updated_aug19.gff",header = F,skip = 2,sep = "\t",stringsAsFactors = F,quote = "",fill = T,comment.char = "")
GFF<-GFF[1:(grep("##FASTA",GFF[,1])-1),]
features_table<-data.frame(matrix(NA,ncol=5,nrow=nrow(GFF)))
colnames(features_table)<-c("START","END","NAME","TYPE","PRODUCT")
for (i in 1:nrow(features_table)){
if (GFF[i,5]<GFF[i,4]){
features_table$START[i]<-GFF[i,5]
features_table$END[i]<-GFF[i,4]
} else {
features_table$START[i]<-GFF[i,4]
features_table$END[i]<-GFF[i,5]
}
features_table$TYPE[i]<-GFF[i,3]
a<-unlist(strsplit(GFF[i,9],split = ";"))
b<-a[grep(pattern = "gene=",x = a)]
c<-a[grep(pattern = "product=",x = a)]
d<-a[grep(pattern = "locus_tag=",x = a)]
if (length(d)>0){
features_table$NAME[i]<-substr(d,18,nchar(d))
}
else if (length(b)>0){
features_table$NAME[i]<-substr(b,6,nchar(b))
} else {
features_table$NAME[i]<-a[1]
}
if (length(c)>0){
features_table$PRODUCT[i]<-substr(c,9,nchar(c))
}
}
#write.csv(features_table,"M_bovis_features-locusAsName.csv",row.names = F)
write.csv(features_table,"M_bovis_features-locusAsName-aug19.csv",row.names = F)
#write.csv(features_table,"M_bovis_features-locusAsName.csv",row.names = F)
write.csv(features_table,"M_bovis_features-locusAsName-aug19.csv",row.names = FALSE)
source('~/Tn_seq_project/Dong_scripts/Annotate_GFF-locusAsName.R', echo=TRUE)
source('~/Tn_seq_project/Dong_scripts/Annotate_GFF-locusAsName.R', echo=TRUE)
